je_researching_magic = {
	icon = "gfx/interface/icons/event_icons/event_magic_knowledge.dds"

	group = je_group_magical_affairs

	scripted_button = je_researching_magic_button_focus_academia
	scripted_button = je_researching_magic_button_cancel_focus_academia

	status_desc = {
		first_valid = {
			triggered_desc = {
				desc = je_researching_magic_missing_institute
				trigger = {
					NOT = {
						capital = {
							has_building = building_magic_research_institute
						}
					}
				}
			}
			triggered_desc = {
				desc = je_researching_magic_low_progress
				trigger = {
					scope:journal_entry = {
						scripted_bar_progress = {
							name = pb_gate_researching_magic
							value < 30
						}
					}
				}
			}
			triggered_desc = {
				desc = je_researching_magic_medium_progress
				trigger = {
					scope:journal_entry = {
						scripted_bar_progress = {
							name = pb_gate_researching_magic
							value < 60
						}
					}
				}
			}
			triggered_desc = {
				desc = je_researching_magic_high_progress
				trigger = {
					scope:journal_entry = {
						scripted_bar_progress = {
							name = pb_gate_researching_magic
							value <= 100
						}
					}
				}
			}
		}
	}

	complete = {
		trigger_if = {
			custom_tooltip = {
				text = je_researching_magic_goal_tt
				scope:journal_entry = {
					scripted_bar_progress = {
						name = pb_gate_researching_magic
						value >= 100
					}
				}
			}
		}
	}

	invalid = {
		trigger_if = {
			hidden_trigger = {
				is_magic_country = yes
			}
		}
	}

	immediate = {
		create_character = {
			template = magic_researcher_template
			save_scope_as = magic_researcher
		}
		# Our researcher complaining about the missing institute
		scope:magic_researcher = {
			set_variable = {
				name = com_opinion
				value = flag:character_opinion_magic_researcher_missing_institute
			}
		}
		set_variable = {
			name = magic_researcher
			value = scope:magic_researcher
		}
		scope:journal_entry = {
			add_to_variable_list = {
				name = com_journal_characters
				target = scope:magic_researcher
			}
		}
	}

	on_complete = {
		hidden_effect = {
			remove_modifier = focus_researching_magic_cost_modifier
			var:magic_researcher = {
				set_character_immortal = no
			}
		}
		learn_magic = yes
	}

	on_invalid = {
		hidden_effect = {
			remove_modifier = focus_researching_magic_cost_modifier
			var:magic_researcher = {
				set_character_immortal = no
			}
		}
	}

	progressbar = no

	scripted_progress_bar = pb_gate_researching_magic

	transferable = no
	can_revolution_inherit = yes

	weight = 200
	should_be_pinned_by_default = yes
}