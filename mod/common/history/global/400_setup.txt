# This scripts are run after all other history scripts were run
GLOBAL = {
	set_global_variable = {
		name = magic_growing_var
		value = 0
	}

	# Every country has a journal entry for mana saturation
	# since some countries can interact with the journal entry
	every_country = {
		limit = {
			NOT = {
				is_country_type = decentralized
			}
		}
		add_journal_entry = {
			type = je_mana_saturation
		}
	}

	add_mage_towers = yes

	# Add custom buttons
	add_magic_main_button = yes
	add_magic_technology_button = yes

	# Set global base magic innovation and calculate it
	set_global_variable = {
		name = weekly_magic_innovation_base
		value = 25
	}
	every_country = {
		calculate_magic_research = yes
	}

	# Statistics GUI
	collect_magic_countries = yes

	every_in_global_list = {
		variable = magic_countries

		# Set Monster Hunting ideologies to
		# existing interest groups for all
		# magic countries
		add_monster_hunting_ideologies = yes

		# Add research institute to all magic
		# countries
		every_scope_state = {
			limit = {
				is_capital = yes
			}
			create_building = {
				building = building_magic_research_institute
				level = 1
			}
		}

		# Add magic researcher to all magic
		# countries
		create_character = {
			template = magic_researcher_template
			interest_group = ig_magic_users
			save_scope_as = magic_researcher
		}
		set_variable = {
			name = magic_researcher
			value = scope:magic_researcher
		}
	}

	# Custom War Goals
	add_to_global_variable_list = {
		name = wgf_custom_war_goals_types
		target = bt:gate_war_goal_type_magic
	}
	add_to_global_variable_list = {
		name = wgf_custom_war_goals
		target = bt:gate_war_goal_demand_magic
	}
}
