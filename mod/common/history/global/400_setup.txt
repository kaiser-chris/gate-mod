# This scripts are run after all other history scripts were run
GLOBAL = {

	# Fixes colonization issues
	c:GNS = {
		activate_law = law_type:law_gnomish_integration
	}

	c:GAD = {
		activate_law = law_type:law_frontier_colonization
		set_institution_investment_level = {
			institution = institution_colonial_affairs
			level = 2
		}
		create_diplomatic_pact = {
			country = c:CHK
			type = puppet
		}
		create_diplomatic_pact = {
			country = c:KZM
			type = puppet
		}
		create_diplomatic_pact = {
			country = c:KSN
			type = puppet
		}
		create_diplomatic_pact = {
			country = c:LND
			type = puppet
		}
		create_diplomatic_pact = {
			country = c:TSW
			type = protectorate
		}
	}
	c:KZM = {
		add_liberty_desire = 15
	}
	c:LND = {
		add_liberty_desire = 15
	}
	c:KSN = {
		add_liberty_desire = 15
	}
	c:CHK = {
		add_liberty_desire = 15
	}
	c:TSW = {
		add_liberty_desire = -5
	}

	set_global_variable = {
		name = magic_growing_var
		value = 0
	}

	# Every country has a journal entry for mana saturation
	# since some countries can interact with the journal entry
	every_country = {
		limit = {
			NOT = {
				is_country_type = decentralized
			}
		}
		add_journal_entry = {
			type = je_mana_saturation
		}
	}

	# Add custom buttons
	add_magic_main_button = yes
	add_magic_technology_button = yes

	set_global_variable = {
		name = magic_innovation_bank_max
		value = 30000
	}

	# Calculate magic innovation
	every_country = {
		set_variable = {
			name = magic_innovation
			value = 0
		}
		calculate_magic_research = yes
	}

	# Statistics GUI
	collect_magic_countries = yes

	every_in_global_list = {
		variable = magic_countries

		# Set Monster Hunting ideologies to
		# existing interest groups for all
		# magic countries
		add_monster_hunting_ideologies = yes

		save_temporary_scope_as = magic_country

		# Add magic researcher to all magic
		# countries
		create_character = {
			template = magic_researcher_template
			interest_group = ig_magic_users
		}

		# Established Magic Countries
		# should have a Mage Tower in every state
		every_scope_state = {
			create_mage_tower = {
				country = scope:magic_country
				level = 1
			}
		}
	}

	# Custom War Goals
	add_to_global_variable_list = {
		name = wgf_custom_war_goals_types
		target = bt:gate_war_goal_type_magic
	}
	add_to_global_variable_list = {
		name = wgf_custom_war_goals
		target = bt:gate_war_goal_demand_magic
	}
}
